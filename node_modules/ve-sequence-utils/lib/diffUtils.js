"use strict";

var _require = require("lodash"),
    cloneDeep = _require.cloneDeep,
    forEach = _require.forEach;

var differ = require("jsondiffpatch").create({
  // cloneDiffValues: true
});

var getDiffFromSeqs = function getDiffFromSeqs(oldData, newData) {
  [oldData, newData].forEach(function (d) {
    ["cutsites", "orfs", "filteredFeatures", "size"].forEach(function (prop) {
      delete d[prop];
    });
    if (d.translations) {
      forEach(d.translations, function (translation) {
        delete translation.aminoAcids;
      });
    }
  });

  // try {
  //   delete oldData.trn;
  //   delete newData.trn;
  // }

  return differ.diff(oldData, newData);
};
var patchSeqWithDiff = function patchSeqWithDiff(oldData, diff) {
  return differ.patch(cloneDeep(oldData), diff);
};
var reverseSeqDiff = function reverseSeqDiff(diff) {
  return differ.reverse(diff);
};

module.exports = { getDiffFromSeqs: getDiffFromSeqs, patchSeqWithDiff: patchSeqWithDiff, reverseSeqDiff: reverseSeqDiff };