'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var react=require('react'),observerUtil=require('@nx-js/observer-util');const COMPONENT=Symbol('owner component'),DUMMY_STATE={};function view(a,{devtool:b}={}){const c=!(a.prototype&&a.prototype.isReactComponent),d=c?react.Component:a,e=b?c=>b(Object.assign({Component:a},c)):void 0;class f extends d{constructor(a,b){super(a,b),this.state=this.state||{},this.state[COMPONENT]=this,this.render=observerUtil.observe(this.render,{scheduler:()=>this.setState(DUMMY_STATE),debugger:e,lazy:!0})}render(){return c?a(this.props,this.context):super.render()}shouldComponentUpdate(a,b){const{props:c,state:d}=this;if(super.shouldComponentUpdate&&!super.shouldComponentUpdate(a,b))return e&&e({type:'render',renderType:'blocked'}),!1;if(d!==b)return e&&e({type:'render',renderType:'reactive'}),!0;const f=Object.keys(c),g=Object.keys(a);return!!(g.length!==f.length||g.some(b=>c[b]!==a[b]))&&(e&&e({type:'render',renderType:'normal',props:a,oldProps:c}),!0)}static getDerivedStateFromProps(a,b){if(super.deriveStoresFromProps){const c=mapStateToStores(b);super.deriveStoresFromProps(a,...c)}return super.getDerivedStateFromProps?super.getDerivedStateFromProps(a,b):null}componentWillUnmount(){super.componentWillUnmount&&super.componentWillUnmount(),observerUtil.unobserve(this.render)}}if(f.displayName=a.displayName||a.name,c)for(let b of Object.keys(a))f[b]=a[b];return f}function mapStateToStores(a){const b=a[COMPONENT];return Object.keys(b).map(a=>b[a]).filter(observerUtil.isObservable).map(observerUtil.raw)}exports.store=observerUtil.observable,exports.view=view;