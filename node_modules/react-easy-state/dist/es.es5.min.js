import{Component}from'react';import{observe,unobserve,raw,isObservable}from'@nx-js/observer-util';export{observable as store}from'@nx-js/observer-util';var COMPONENT=Symbol('owner component'),DUMMY_STATE={};function view(a,b){void 0===b&&(b={});var c=b.devtool,d=!(a.prototype&&a.prototype.isReactComponent),e=d?Component:a,f=c?function(b){return c(Object.assign({Component:a},b))}:void 0,g=function(b){function c(a,c){var d=this;b.call(this,a,c),this.state=this.state||{},this.state[COMPONENT]=this,this.render=observe(this.render,{scheduler:function(){return d.setState(DUMMY_STATE)},debugger:f,lazy:!0})}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.render=function(){return d?a(this.props,this.context):b.prototype.render.call(this)},c.prototype.shouldComponentUpdate=function(a,c){var d=this,e=d.props,g=d.state;if(b.prototype.shouldComponentUpdate&&!b.prototype.shouldComponentUpdate.call(this,a,c))return f&&f({type:'render',renderType:'blocked'}),!1;if(g!==c)return f&&f({type:'render',renderType:'reactive'}),!0;var h=Object.keys(e),i=Object.keys(a);return!!(i.length!==h.length||i.some(function(b){return e[b]!==a[b]}))&&(f&&f({type:'render',renderType:'normal',props:a,oldProps:e}),!0)},c.getDerivedStateFromProps=function(a,c){if(b.deriveStoresFromProps){var d=mapStateToStores(c);b.deriveStoresFromProps.apply(this,[a].concat(d))}return b.getDerivedStateFromProps?b.getDerivedStateFromProps.call(this,a,c):null},c.prototype.componentWillUnmount=function(){b.prototype.componentWillUnmount&&b.prototype.componentWillUnmount.call(this),unobserve(this.render)},c}(e);if(g.displayName=a.displayName||a.name,d)for(var h,j=0,k=Object.keys(a);j<k.length;j+=1)h=k[j],g[h]=a[h];return g}function mapStateToStores(a){var b=a[COMPONENT];return Object.keys(b).map(function(a){return b[a]}).filter(isObservable).map(raw)}export{view};